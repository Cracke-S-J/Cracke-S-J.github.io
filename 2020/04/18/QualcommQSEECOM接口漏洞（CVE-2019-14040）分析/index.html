<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>Qualcomm QSEECOM 接口漏洞（CVE-2019-14040）分析 | </title>
    <meta name="author" content="ssj">
    
    <meta name="description" content="致谢参考
https://blog.zimperium.com/multiple-kernel-vulnerabilities-affecting-all-qualcomm-devices/
https://paper.seebug.org/1179/
这是相关源码https://android.g">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="Qualcomm QSEECOM 接口漏洞（CVE-2019-14040）分析">
    <meta property="og:site_name" content="ssj&#39;s blog">

    
    <meta property="og:image" content>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="ssj&#39;s blog" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/tranquil-heart.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
</html>

<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="pink accent-1">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">ssj&#39;s blog</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            Home
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            Archives
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            Categories
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            Reading
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            About
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            Search
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav pink darken-1" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="/pingtou.jpg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">ssj</p>
                        <p class="desc"></p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    Home
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    Archives
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    Categories
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    Reading
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    About
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    Search
                </a>
            </li>
        
    </ul>

    <ul class="side-nav pink darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/CTF/">
                    CTF <span class="right">8</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/CTF/pwn/">
                    pwn <span class="right">7</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/CTF/Android/">
                    Android <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Android/">
                    Android <span class="right">14</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/Android/脱壳/">
                    脱壳 <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/Android/马甲包/">
                    马甲包 <span class="right">2</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/面试体验/">
                    面试体验 <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/面试体验/Android/">
                    Android <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Fuzz/">
                    Fuzz <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/Ethereum/">
                    Ethereum <span class="right">3</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/二进制/">
                    二进制 <span class="right">11</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/二进制/v8/">
                    v8 <span class="right">6</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/二进制/Base/">
                    Base <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/二进制/Kernel/">
                    Kernel <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/二进制/vm/">
                    vm <span class="right">2</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/二进制/Docs/">
                    Docs <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/CVE/">
                    CVE <span class="right">11</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/杂/">
                    杂 <span class="right">5</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/杂/定场诗/">
                    定场诗 <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/杂/听戏/">
                    听戏 <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/杂/京剧/">
                    京剧 <span class="right">3</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/基础知识/">
                    基础知识 <span class="right">2</span></a>
                </a>
            </li>

        

            <li class="collapse-level-1" collapse-level="1">
                <a class="no-padding" href="/categories/基础知识/Cpp/">
                    Cpp <span class="right">1</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/算法/">
                    算法 <span class="right">1</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">Search</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper pink">
        <span class="breadcrumb">Current page(Categories)</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/CVE/">CVE</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>Qualcomm QSEECOM 接口漏洞（CVE-2019-14040）分析</h1>
    


            </div>
            <time class="pink-link-context" datetime="2020-04-18T02:54:56.000Z"><a href="/2020/04/18/QualcommQSEECOM接口漏洞（CVE-2019-14040）分析/">2020-04-18</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/CVE/" class="chip pink lighten-1">CVE</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#致谢参考"><span class="section table-of-contents-text">致谢参考</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#背景"><span class="section table-of-contents-text">背景</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#TEE是什么"><span class="section table-of-contents-text">TEE是什么</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#Qualcomm是什么"><span class="section table-of-contents-text">Qualcomm是什么</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#QSEECOM是什么"><span class="section table-of-contents-text">QSEECOM是什么</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#漏洞成因-–-这是一个-U-A-F"><span class="section table-of-contents-text">漏洞成因 – 这是一个 U A F</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#Free-过程"><span class="section table-of-contents-text">Free 过程</span></a></li><li class="section table-of-contents-item section table-of-contents-level-3"><a class="section table-of-contents-link" href="#Use-过程"><span class="section table-of-contents-text">Use 过程</span></a></li></ol></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#利用"><span class="section table-of-contents-text">利用</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#总结"><span class="section table-of-contents-text">总结</span></a></li></ol>
</div>


            <div class="entry pink-link-context">
                <h2 id="致谢参考"><a href="#致谢参考" class="headerlink" title="致谢参考"></a>致谢参考</h2><ol>
<li><a href="https://blog.zimperium.com/multiple-kernel-vulnerabilities-affecting-all-qualcomm-devices/" target="_blank" rel="noopener">https://blog.zimperium.com/multiple-kernel-vulnerabilities-affecting-all-qualcomm-devices/</a></li>
<li><a href="https://paper.seebug.org/1179/" target="_blank" rel="noopener">https://paper.seebug.org/1179/</a></li>
<li>这是相关源码<a href="https://android.googlesource.com/kernel/msm/+/refs/heads/android-msm-crosshatch-4.9-android10/drivers/misc/qseecom.c" target="_blank" rel="noopener">https://android.googlesource.com/kernel/msm/+/refs/heads/android-msm-crosshatch-4.9-android10/drivers/misc/qseecom.c</a></li>
</ol>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><h3 id="TEE是什么"><a href="#TEE是什么" class="headerlink" title="TEE是什么"></a>TEE是什么</h3><p>TEE即可信执行环境，全称Trusted Execution Environment。该环境可以保证不被常规的Rich OS（如Windows，Android）干扰，因此是可信的。TEE目前被用于向Rich OS提供各种各样的安全服务。TEE独立于Rich OS上的各种应用，并可以访问硬件和软件安全资源。TEE在x86/x64/ARM/ARM64上都有相关支持与实现，另一个我们比较熟悉的称呼是ARM/ARM64架构手机上的TrustZone。</p>
<p>讲得简单点，现在我们用的Android手机上都有指纹识别，这就需要用到TEE，因为指纹这些生物信息保存在Android系统里的话并不安全，因为手机可能被恶意应用root掉，然后里面的文件都是可以被获取查看的。因此，这就需要把一些非常隐私的数据保存在更加深的地方。</p>
<p>那么有多深呢？以ARM架构的Android系统为例，普通的应用进程运行在EL0层；Android系统包括系统框架、内核等代码运行在EL1层；部分设备还有虚拟化需求，那就需要在EL2层运行hypervisor；而如果要使用TEE相关技术的话，那就需要EL3层运行Secure Monitor，由该层进行安全环境（TEE kernel）与普通环境（Rich OS）的切换。</p>
<p>当前主流的TEE厂商与产品有：Intel的SGX，Qualcomm的QSEE，Huawei HiSilicon的Trusted Core以及Samsung的Kinibi。那么既然TEE能做到如此强的隔离，是不是其中的信息安全就坚不可破了呢？并不是，我们知道，大部分Android手机会使用高通SoC，因此上面运行的TEE Kernel就是QSEE。</p>
<h3 id="Qualcomm是什么"><a href="#Qualcomm是什么" class="headerlink" title="Qualcomm是什么"></a>Qualcomm是什么</h3><p>就是一个公司名，翻译过来叫“<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E9%80%9A" target="_blank" rel="noopener">高通</a>”。它应该是一个通信公司（我也不太懂）。</p>
<h3 id="QSEECOM是什么"><a href="#QSEECOM是什么" class="headerlink" title="QSEECOM是什么"></a>QSEECOM是什么</h3><p>QSEECOM是一种Linux内核设备，可让MediaServer（它在正常的操作系统中运行，也即“正常世界”）等通常的用户空间进程与安全操作系统下受信任的应用（也被称为trustlet，管理着受保护的服务和硬件，后者也被称为“安全世界”）进行通信。因此，“正常世界”中运行的恶意软件可以调用trustlet，利用其中的漏洞入侵设备。</p>
<p>媒体服务器是一个专用的计算机设备或专门的应用软件,从一个企业类提供视频点播机,,更常见的,一个小的个人电脑或NAS(网络附加存储),专门用于存储各种数字媒体(数字视频/电影,音频/音乐,和图片文件)。这也意味着这些服务器是专门用于媒体流的。</p>
<p>简单介绍一下这个QSEECOM接口，它是一个内核驱动连接用户态Normal world和Secure world的一个桥梁，Secure world就是我们常说的Trustzone/TEE/Security Enclav安全运行环境，Normalworld就是非安全运行环境，这个高通的QSEECOM接口可以实现一些从用户态加载/卸载一些安全的TA（TrustApplcation）到TrustZone中去运行，比如我们手机常用的指纹/人脸识别的应用，这些应用都是在TrustZone中运行的，在这种运行环境下，可以保证我们用户的关键隐私不被窃取，这个QSEECOM架构如下。</p>
<p>要想了解这个漏洞的成因，需要先了解这个QSEECOM接口的功能处理逻辑，用户态通过ION设备（一个内存管理器，可以通过打开/dev/ion进行访问）申请的内存可以通过QSEECOM接口映射到内核地址空间，可供内核或者TrustZone访问，而对于QSEECOM驱动模型中（/dev/qseecom）提供给用户的接口有open/close/ioctl，对应着QSEECOM内核处理函数为qseecom_open/qseecom_ioctl/qseecom_release。</p>
<h2 id="漏洞成因-–-这是一个-U-A-F"><a href="#漏洞成因-–-这是一个-U-A-F" class="headerlink" title="漏洞成因 – 这是一个 U A F"></a>漏洞成因 – 这是一个 U A F</h2><h3 id="Free-过程"><a href="#Free-过程" class="headerlink" title="Free 过程"></a>Free 过程</h3><p>用户态每次打开qseecom设备（/dev/qseecom），都会在内核态生成一个qseecom_dev_handle的结构指针，这个结构指针会被关闭qseecom设备（用户态通过close函数）或者来自用户的IO操作号QSEECOM_IOCTL_UNLOAD_APP_REQ请求予以销毁，先看一下这个指针的初始化过程。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">qseecom_open</span><span class="params">(struct inode *inode, struct file*file)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_dev_handle</span> *<span class="title">data</span>;</span></span><br><span class="line">  data = kzalloc(<span class="keyword">sizeof</span>(*data), GFP_KERNEL);</span><br><span class="line">  <span class="keyword">if</span> (!data)</span><br><span class="line">    <span class="keyword">return</span> -ENOMEM;</span><br><span class="line">  file-&gt;private_data= data;</span><br><span class="line">  data-&gt;<span class="built_in">abort</span> = <span class="number">0</span>;</span><br><span class="line">  …</span><br></pre></td></tr></table></figure>
<p>用户通过<code>QSEECOM_IOCTL_SET_MEM_PARAM_REQ</code> ioctl请求通过函数qseecom_set_client_mem_param来建立用户态ion内存在内核地址空间的映射，而qseecom_set_client_mem_param函数通过copy_from_user函数来获取用户传递的ion用户内存的地址信息以及这个内存的长度信息。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">qseecom_set_client_mem_param</span><span class="params">(struct qseecom_dev_handle *data,</span></span></span><br><span class="line"><span class="function"><span class="params">                        <span class="keyword">void</span> __user *argp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">ion_phys_addr_t</span> pa;</span><br><span class="line">    <span class="keyword">int32_t</span> ret;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_set_sb_mem_param_req</span> <span class="title">req</span>;</span></span><br><span class="line">    <span class="keyword">size_t</span> len;</span><br><span class="line">    <span class="comment">/* Copy the relevant information needed for loading the image */</span></span><br><span class="line">    <span class="keyword">if</span> (copy_from_user(&amp;req, (<span class="keyword">void</span> __user *)argp, <span class="keyword">sizeof</span>(req)))</span><br><span class="line">        <span class="keyword">return</span> -EFAULT;</span><br><span class="line">    <span class="keyword">if</span> ((req.ifd_data_fd &lt;= <span class="number">0</span>) || (req.virt_sb_base == <span class="literal">NULL</span>) ||</span><br><span class="line">                    (req.sb_len == <span class="number">0</span>)) &#123;</span><br><span class="line">        pr_err(<span class="string">"Inavlid input(s)ion_fd(%d), sb_len(%d), vaddr(0x%pK)\n"</span>,</span><br><span class="line">            req.ifd_data_fd, req.sb_len, req.virt_sb_base);</span><br><span class="line">        <span class="keyword">return</span> -EFAULT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!access_ok(VERIFY_WRITE, (<span class="keyword">void</span> __user *)req.virt_sb_base,</span><br><span class="line">            req.sb_len))</span><br><span class="line">        <span class="keyword">return</span> -EFAULT;</span><br><span class="line">    <span class="comment">/* Get the handle of the shared fd */</span></span><br><span class="line">    data-&gt;client.ihandle = ion_import_dma_buf_fd(qseecom.ion_clnt,</span><br><span class="line">                        req.ifd_data_fd);</span><br><span class="line">    <span class="keyword">if</span> (IS_ERR_OR_NULL(data-&gt;client.ihandle)) &#123;</span><br><span class="line">        pr_err(<span class="string">"Ion client could not retrieve the handle\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> -ENOMEM;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* Get the physical address of the ION BUF */</span></span><br><span class="line">    ret = ion_phys(qseecom.ion_clnt, data-&gt;client.ihandle, &amp;pa, &amp;len);</span><br><span class="line">    <span class="keyword">if</span> (ret) &#123;</span><br><span class="line">        pr_err(<span class="string">"Cannot get phys_addr for the Ion Client, ret = %d\n"</span>,</span><br><span class="line">            ret);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (len &lt; req.sb_len) &#123;</span><br><span class="line">        pr_err(<span class="string">"Requested length (0x%x) is &gt; allocated (%zu)\n"</span>,</span><br><span class="line">            req.sb_len, len);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* Populate the structure for sending scm call to load image */</span></span><br><span class="line">    data-&gt;client.sb_virt = (<span class="keyword">char</span> *) ion_map_kernel(qseecom.ion_clnt,</span><br><span class="line">                            data-&gt;client.ihandle);</span><br><span class="line">    <span class="keyword">if</span> (IS_ERR_OR_NULL(data-&gt;client.sb_virt)) &#123;</span><br><span class="line">        pr_err(<span class="string">"ION memory mapping for client shared buf failed\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> -ENOMEM;</span><br><span class="line">    &#125;</span><br><span class="line">    data-&gt;client.sb_phys = (<span class="keyword">phys_addr_t</span>)pa;</span><br><span class="line">    data-&gt;client.sb_length = req.sb_len;</span><br><span class="line">    data-&gt;client.user_virt_sb_base = (<span class="keyword">uintptr_t</span>)req.virt_sb_base;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看一下qseecom_dev_handle结构体，和qseecom_dev_handle-&gt;client：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qseecom_dev_handle</span> &#123;</span></span><br><span class="line">  <span class="keyword">enum</span> qseecom_client_handle_type type;</span><br><span class="line">  <span class="keyword">union</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_client_handle</span> <span class="title">client</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_listener_handle</span> <span class="title">listener</span>;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">bool</span> released;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qseecom_client_handle</span> &#123;</span></span><br><span class="line">  u32 app_id;</span><br><span class="line">  u8 *sb_virt;</span><br><span class="line">  <span class="keyword">phys_addr_t</span> sb_phys;</span><br><span class="line">  <span class="keyword">unsigned</span> longuser_virt_sb_base;</span><br><span class="line">  <span class="keyword">size_t</span> sb_length;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">ion_handle</span> *<span class="title">ihandle</span>;</span>   <span class="comment">/*Retrieve phy addr */</span></span><br><span class="line">  charapp_name[MAX_APP_NAME_SIZE];</span><br><span class="line">  u32 app_arch;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_sec_buf_fd_info</span> <span class="title">sec_buf_fd</span>[<span class="title">MAX_ION_FD</span>];</span></span><br><span class="line">  <span class="keyword">bool</span> from_smcinvoke;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>再看一下free过程：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">qseecom_unmap_ion_allocated_memory</span><span class="params">(struct qseecom_dev_handle*data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">if</span>(!IS_ERR_OR_NULL(data-&gt;client.ihandle)) &#123;</span><br><span class="line">      ion_unmap_kernel(qseecom.ion_clnt,data-&gt;client.ihandle);<span class="comment">//解除用户态 ion内存到内核态的映射</span></span><br><span class="line">       ion_free(qseecom.ion_clnt,data-&gt;client.ihandle);</span><br><span class="line">       data-&gt;client.ihandle= <span class="literal">NULL</span>; <span class="comment">//只是把这个指针置空了</span></span><br><span class="line">   &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里它只处理了ihandle，free并置空；并没有看到把其它成员置空（说实话free我也没看到，对着源码一通找，作者说没有就是没有），所以会造成后续再use。</p>
<h3 id="Use-过程"><a href="#Use-过程" class="headerlink" title="Use 过程"></a>Use 过程</h3><p>重新分配相同大小的堆块，还挺容易命中的，遗憾的是我们再open，但初始化的时候也没有清残留数据。我们身为用户态要想办法手动use到这些没有释放的东西。</p>
<p>我们的目标是能够使用这些free掉的结构中残留的数据，如何能够保证残留数据可用，第一，残留的关键数据不被接下来的流程所覆盖，第二，保护流程正常走下去，现有的qseecom_dev_handle结构不被无效的操作释放。为了保证满足第二条，我们需要满足qseecom_dev_handle成员client的ihandle指针不能为空（__validate_send_service_cmd_inputs会检查），因为之前释放的时候这里被置空了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> __validate_send_service_cmd_inputs(struct qseecom_dev_handle *data,</span><br><span class="line">                struct qseecom_send_svc_cmd_req *req)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!req || !req-&gt;resp_buf || !req-&gt;cmd_req_buf) &#123;</span><br><span class="line">        pr_err(<span class="string">"req or cmd buffer or response buffer is null\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!data || !data-&gt;client.ihandle) &#123;</span><br><span class="line">        pr_err(<span class="string">"Client or client handle is not initialized\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>为了达到这个残留数据不被覆盖的目标，只需要用户态发送一个QSEECOM_IOCTL_SET_MEM_PARAM_REQ ioctl请求，且用户提交的ION内存分配的长度信息大于实际用户所分配的大小即可，例如用户只分配了0x1000字节内存，但是用户提交给内核说我分配了0x2000个字节，这时内核检测出来会返回错误，但是看qseecom_set_client_mem_param函数处理流程，qseecom_dev_handle指针没有被销毁，那个残留数据也没有被覆盖，所以结构体里面的ihandle也赋值了不为空，两个条件都满足了，然后接下来的正常业务处理逻辑将会把之前残留的sb_virt/sb_phys地址用于内存读写操作，完成真正的use操作。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> __qseecom_send_modfd_cmd(struct qseecom_dev_handle *data,</span><br><span class="line">                    <span class="keyword">void</span> __user *argp,</span><br><span class="line">                    <span class="keyword">bool</span> is_64bit_addr)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_send_modfd_cmd_req</span> <span class="title">req</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">qseecom_send_cmd_req</span> <span class="title">send_cmd_req</span>;</span></span><br><span class="line">    ret = copy_from_user(&amp;req, argp, <span class="keyword">sizeof</span>(req));</span><br><span class="line">    <span class="keyword">if</span> (ret) &#123;</span><br><span class="line">        pr_err(<span class="string">"copy_from_user failed\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    send_cmd_req.cmd_req_buf = req.cmd_req_buf;</span><br><span class="line">    send_cmd_req.cmd_req_len = req.cmd_req_len;</span><br><span class="line">    send_cmd_req.resp_buf = req.resp_buf;</span><br><span class="line">    send_cmd_req.resp_len = req.resp_len;</span><br><span class="line">    <span class="keyword">if</span> (__validate_send_cmd_inputs(data, &amp;send_cmd_req))</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line">    <span class="comment">/* validate offsets */</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; MAX_ION_FD; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (req.ifd_data[i].cmd_buf_offset &gt;= req.cmd_req_len) &#123;</span><br><span class="line">            pr_err(<span class="string">"Invalid offset %d = 0x%x\n"</span>,</span><br><span class="line">                i, req.ifd_data[i].cmd_buf_offset);</span><br><span class="line">            <span class="keyword">return</span> -EINVAL;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    req.cmd_req_buf = (<span class="keyword">void</span> *)__qseecom_uvirt_to_kvirt(data,</span><br><span class="line">                        (<span class="keyword">uintptr_t</span>)req.cmd_req_buf);</span><br><span class="line">    req.resp_buf = (<span class="keyword">void</span> *)__qseecom_uvirt_to_kvirt(data,</span><br><span class="line">                        (<span class="keyword">uintptr_t</span>)req.resp_buf);</span><br><span class="line">    <span class="keyword">if</span> (!is_64bit_addr) &#123;</span><br><span class="line">        ret = __qseecom_update_cmd_buf(&amp;req, <span class="literal">false</span>, data);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        ret = __qseecom_send_cmd(data, &amp;send_cmd_req);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        ret = __qseecom_update_cmd_buf(&amp;req, <span class="literal">true</span>, data);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ret = __qseecom_update_cmd_buf_64(&amp;req, <span class="literal">false</span>, data);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        ret = __qseecom_send_cmd(data, &amp;send_cmd_req);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        ret = __qseecom_update_cmd_buf_64(&amp;req, <span class="literal">true</span>, data);</span><br><span class="line">        <span class="keyword">if</span> (ret)</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><p>放一个<a href="https://github.com/tamirzb/CVE-2019-14040">poc</a>，还没分析过。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这种UAF其实是，用户态和内核态不同步造成的，内核态给用户态报错了，但是我用户就要继续用，就造成了问题。这个分析偏原理，因为没有找到比较好的POC。</p>

                
<p class="pink-link-context">
    <a href="/2020/04/18/v8编译环境搭建/" rel="next" title="v8 编译环境搭建">
    Prev: v8 编译环境搭建
  </a>
</p>



<p class="pink-link-context">
    <a href="/2020/04/15/LinuxPWN相关知识整理/" rel="next" title="Linux pwn 相关知识整理">
    Next: Linux pwn 相关知识整理
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>






</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect pink" title="Return to top"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse pink darken-1"  data-activates="main-menu" title="Menu"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer pink accent-1 darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">Social</h5>
                
                    <a class="social-link" href="https://github.com/cracke-s-j" target="_blank">
                        <i class="fa fa-2x fa-github"></i>
                    </a>
                
                

            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">Links</h5>
                
                    <a class="social-link" href="https://blog.dyf.ink/" target="_blank">友情链接 dyf&#39;s blog</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            © 2020 ssj, All rights reserved.
            <p class="right" style="margin-top: 0;">Blog powered by <a href="https://hexo.io">Hexo</a> | Theme <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            
            // 添加new标签
            $('').append('<span class="new badge pink"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"width":250,"height":500,"position":"left","hOffset":0,"vOffset":-100},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
